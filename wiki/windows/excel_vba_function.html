<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="Stylesheet" type="text/css" href="../styles/style.css" />
    <title>Excel VBA 内建函数</title>
</head>
<body>
<div id="header">
    <ul id="top-nav">
    <li><a href="../index.html">首页</a></li>
    <li><a href="index.html">分类首页</a></li>
    </ul>
</div>
<div id="cse"></div>
<div id="main">

<h1>Excel VBA 内建函数</h1>
<div class="toc">
<ul>
<li><a href="#toc_0.1">测试函数</a>
<li><a href="#toc_0.2">数学函数</a>
<li><a href="#toc_0.3">字符串函数</a>
<li><a href="#toc_0.4">转换函数</a>
<li><a href="#toc_0.5">时间函数</a>
</ul>
</ul>
</div>

<p>
在VBA程序语言中有许多内置函数，可以帮助程序代码设计和减少代码的编写工作。
</p>

<h2 id="toc_0.1">测试函数</h2>

<p>
IsNumeric(x) ‘是否为数字, 返回Boolean结果，True or False
</p>

<p>
IsDate(x) ‘是否是日期, 返回Boolean结果，True or False
</p>

<p>
IsEmpty（x） ‘是否为Empty, 返回Boolean结果，True or False
</p>

<p>
IsArray(x) ‘指出变量是否为一个数组。
</p>

<p>
IsError(expression) ‘指出表达式是否为一个错误值
</p>

<p>
IsNull(expression) ‘指出表达式是否不包含任何有效数据 (Null)。
</p>

<p>
IsObject(identifier)‘指出标识符是否表示对象变量
</p>

<h2 id="toc_0.2">数学函数</h2>

<p>
Sin(X)、Cos(X)、Tan(X)、Atan(x) 三角函数，单位为弧度
</p>

<p>
Log(x) 返回x的自然对数
</p>

<p>
Exp(x)返回 ex
</p>

<p>
Abs(x) 返回绝对值
</p>

<p>
Int(number)、Fix(number) 都返回参数的整数部分，区别：Int 将 -8.4 转换成 -9，而 Fix 将-8.4 转换成 -8
</p>

<p>
Sgn(number) 返回一个 Variant (Integer)，指出参数的正负号
</p>

<p>
Sqr(number) 返回一个 Double，指定参数的平方根
</p>

<p>
VarType(varname) 返回一个 Integer，指出变量的子类型
</p>

<p>
Rnd（x）返回0-1之间的单精度数据，x为随机种子
</p>

<h2 id="toc_0.3">字符串函数</h2>

<p>
Trim(string) 去掉string左右两端空白
</p>

<p>
Ltrim(string) 去掉string左端空白
</p>

<p>
Rtrim(string) 去掉string右端空白
</p>

<p>
Len(string) 计算string长度
</p>

<p>
Left(string, x) 取string左段x个字符组成的字符串
</p>

<p>
Right(string, x) 取string右段x个字符组成的字符串
</p>

<p>
Mid(string, start,x) 取string从start位开始的x个字符组成的字符串
</p>

<p>
Ucase(string) 转换为大写
</p>

<p>
Lcase(string) 转换为小写
</p>

<p>
Space(x) 返回x个空白的字符串
</p>

<p>
Asc(string) 返回一个 integer，代表字符串中首字母的字符代码
</p>

<p>
Chr(charcode) 返回 string,其中包含有与指定的字符代码相关的字符
</p>

<h2 id="toc_0.4">转换函数</h2>

<p>
CBool(expression) 转换为Boolean型
</p>

<p>
CByte(expression) 转换为Byte型
</p>

<p>
CCur(expression) 转换为Currency型
</p>

<p>
CDate(expression) 转换为Date型
</p>

<p>
CDbl(expression) 转换为Double型
</p>

<p>
CDec(expression) 转换为Decemal型
</p>

<p>
CInt(expression) 转换为Integer型
</p>

<p>
CLng(expression) 转换为Long型
</p>

<p>
CSng(expression) 转换为Single型
</p>

<p>
CStr(expression) 转换为String型
</p>

<p>
CVar(expression) 转换为Variant型
</p>

<p>
Val(string) 转换为数据型
</p>

<p>
Str(number) 转换为String
</p>

<h2 id="toc_0.5">时间函数</h2>

<p>
Now 返回一个 Variant (Date)，根据计算机系统设置的日期和时间来指定日期和时间。
</p>

<p>
Date 返回包含系统日期的 Variant (Date)。
</p>

<p>
Time 返回一个指明当前系统时间的 Variant (Date)。
</p>

<p>
Timer 返回一个 Single，代表从午夜开始到现在经过的秒数。
</p>

<p>
TimeSerial(hour, minute, second) 返回一个 Variant (Date)，包含具有具体时、分、秒的时间。
</p>

<p>
DateDiff(interval, date1, date2[, firstdayofweek[, firstweekofyear]]) 返回 Variant (Long) 的值，表示两个指定日期间的时间间隔数目
</p>

<p>
Second(time) 返回一个 Variant (Integer)，其值为 0 到 59 之间的整数，表示一分钟之中的某个秒
</p>

<p>
Minute(time) 返回一个 Variant (Integer)，其值为 0 到 59 之间的整数，表示一小时中的某分钟
</p>

<p>
Hour(time) 返回一个 Variant (Integer)，其值为 0 到 23 之间的整数，表示一天之中的某一钟点
</p>

<p>
Day(date) 返回一个 Variant (Integer)，其值为 1 到 31 之间的整数，表示一个月中的某一日
</p>

<p>
Month(date) 返回一个 Variant (Integer)，其值为 1 到 12 之间的整数，表示一年中的某月
</p>

<p>
Year(date) 返回 Variant (Integer)，包含表示年份的整数。
</p>

<p>
Weekday(date, [firstdayofweek]) 返回一个 Variant (Integer)，包含一个整数，代表某个日期是星期几
</p>

</div>
<div id="footer">
<p>
&copy; 2012 - 2021 XStar
&nbsp;|&nbsp;<a href="http://code.google.com/p/vimwiki/" title="vimwiki">Powerby:Vimwiki</a>
&nbsp;|&nbsp;<a href="http://kwiki.github.io" title="丘迟">Style:丘迟</a>
&nbsp;|&nbsp;<a href="../index.html">首页</a>
&nbsp;|&nbsp;<a href="index.html">分类首页</a>
&nbsp;|&nbsp;<a href="../SiteMap.html">站点地图</a>
</p>
</div>
<script type="text/javascript">var vimwiki_rootpath="../";</script>
<script type="text/javascript" src="https://cdn.staticfile.org/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript" src="../scripts/vimwiki.js"></script>
</body>
</html>

